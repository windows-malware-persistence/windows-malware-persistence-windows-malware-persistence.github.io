# App paths Registry key
### Origin of the technique
Windows stores some of the paths of commands in the registry. More specifically, when a program uses the `ShellExecuteEx` system call and only provides the name of the program, Windows will look in the registry for the location of the program. An example of such a program is the `run prompt`. This  persistence techniques changes the value of this registry key to run malicious code instead.

### How to achieve persistence
Add a command in `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths` or `HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths` and set the (Default) value to the location of the executable.

### Requirements
User priviliges to write to the HKCU key. To let the setting apply to all users, write to the HKLM key. This requires Administrator privileges. 

### The achieved persistence
When a program uses `ShellExecuteEx` with only the name of a program, the program specified in the registry will be executed.

### More information
- https://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/
- https://www.cyberark.com/resources/threat-research-blog/persistence-techniques-that-persist