# Network Provider Registry key
### Origin of the technique
When logging in, Winlogon launches mpnotify, which loads various credential manager DLLs. We can add a malicious DLL to this list.

### How to achieve persistence
Place the malicious DLL in the System32 folder. Add the name of the DLL to the end of `ProviderOrder` in `HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order`. Finally, create `HKLM\SYSTEM\CurrentControlSet\Services\<name>\NetworkProvider` and set:
-   `"Class" = 2` (`REG_DWORD`)
-   `"ProviderPath" = "%SystemRoot%\System32\<name>.dll"` (`REG_EXPAND_SZ`) 
-   `"Name" = "<name>"` (`REG_SZ`)

### Requirements
System privileges to write the file and write to the registry.

### The achieved persistence
Runs with System privileges when the user logs in. 


### More information
- https://persistence-info.github.io/Data/credmandll.html
- https://github.com/gtworek/PSBits/tree/master/PasswordStealing/NPPSpy