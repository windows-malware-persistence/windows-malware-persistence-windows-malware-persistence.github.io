### Origin of the technique
Windows stores some of the locations of command in the registry. More specifically, when a program uses the `ShellExecuteEx` system call and only provides the name of the program, Windows will look in the registry for the location of the program. An example is the run prompt. This  persistence techniques changes the value of this registry key to run malicious code instead.

### How to achieve persistence
Add a command in `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths` or `HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths` and set the (Default) value to the location of the executable.

### Requirements
Administrator privileges to write to the registry, if you write to HKLM. Otherwise user privileges suffice.

### The achieved persistence
When a program uses `ShellExecuteEx` with only the name of a program, the program specified in the registry will be executed.

### More information
- https://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/
- https://www.cyberark.com/resources/threat-research-blog/persistence-techniques-that-persist