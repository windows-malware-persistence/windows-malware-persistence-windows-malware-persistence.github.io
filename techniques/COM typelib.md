# COM typelib
### Origin of the technique
Windows file explorer load TypeLibs.
TypeLibs present information about COM objects, such as available classes and interfaces.
### How to achieve persistence

 `HKEY_CURRENT_USER\Software\Classes\CLSID\<CLSID>\TypeLib\[(Default)]` points to registers that present the typelib. Find such register, then set:
  `HKEY_CURRENT_USER\Software\Classes\TypeLib\<CLSID>\<version>\0\<win64/win32>\[(Default)]` = `script: <path to moniker script>`
In the script, you can define the executable you want to execute.
### Requirements
User privileges. HKLM variants also exist, then admin privileges are required.

### The achieved persistence
The code is executed when the targeted TypeLib is loaded by some process.You can run a exe with arguments.

### More information
- https://cicada-8.medium.com/hijack-the-typelib-new-com-persistence-technique-32ae1d284661