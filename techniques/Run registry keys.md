
### Origin of the technique
Windows has some registry that are meant for running software at log in.

### How to achieve persistence
Place an executable (+ parameters) in one of the following registry keys:
- `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run`
- `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce`
- `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run`
- `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`
- `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce`
- `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run`
- `Software\Microsoft\Windows\CurrentVersion\RunOnceEx\<any name>`
Similarly, you can register DLLs:
- `HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnceEx\<any name>\Depend`
- `HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnceEx\<any name>` (requires registration of DLL by adding it to `HHLM\SOFTWARE\Classes\CLSID\<UUID>\` )
### Requirements
Writing to the HKCU keys require user privileges, and the HKLM require administrator privileges.

### The achieved persistence
Runs on login (HKLM for all user, HKCU only the current user). Runonce is only executed only the first boot and then removed.

### More information
- https://attack.mitre.org/techniques/T1547/001/
- https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/