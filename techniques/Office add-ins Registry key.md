# Office add-ins Registry key
### Origin of the technique
Office products can use add-ins to extend functionality.

### How to achieve persistence
Office has a list of trusted locations in the registry. The DLLs placed here are executed on start of office.
Registry: `HKEY_CURRENT_USER\Software\Microsoft\Office\<version>\Word\Security\Trusted Locations\<name>\[Path]`

Another option is placing the DLL in the appdata folder and linking to it in `HKEY_CURRENT_USER\Software\Microsoft\Office\<version>\<product, e.g., Excel>\Options\[OPEN]`

You can also add VBA addins.
`HKEY_CURRENT_USER\Software\Microsoft\Office\<version>\<product>\AddIns\<AddInName>\[Path]` = `path`
### Requirements
User priviliges to write to the registry.
File write for the plugin is also required.
### The achieved persistence
Runs when the user starts the targeted office product.


### More information
 - https://www.mdsec.co.uk/2019/05/persistence-the-continued-or-prolonged-existence-of-something-part-1-microsoft-office/
 - https://labs.withsecure.com/archive/add-in-opportunities-for-office-persistence/
 - https://pentestlab.blog/2019/12/11/persistence-office-application-startup/
