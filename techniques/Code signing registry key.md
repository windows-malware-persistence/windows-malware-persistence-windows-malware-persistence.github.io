
### Origin of the technique
Windows has some code signing DLLs that are used to verify the security of files.

### How to achieve persistence
You can register a new code signing DLL.
This can be done by adding a key under `HKLM\SOFTWARE\Microsoft\Cryptography\OID\EncodingType 0\<some function>\<CLSID>`.
There are multiple options for functions you can target, see the links below.
Set the value `DLL` to the location of your DLL and `FuncName` to the name of the targeted function. The placed DLL should export the targeted function.

### Requirements
Administrator privileges to write to the registry.

### The achieved persistence
The code is run when the DLL is used, for example when displaying file properties.

### More information
- https://persistence-info.github.io/Data/codesigning.html
- https://github.com/SigmaHQ/sigma/blob/16990093933fe8c82c3ad879d306d706b350162a/rules/windows/registry/registry_set/registry_set_sip_persistence.yml
- https://specterops.io/wp-content/uploads/sites/3/2022/06/SpecterOps_Subverting_Trust_in_Windows.pdf
- https://github.com/gtworek/PSBits/tree/master/SIP

