### Origin of the technique
Winlogon loads various executables and DLLs from the registry.

### How to achieve persistence
Add an execuable to registry key:
`HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon`

Options are:
- `Notify` - points to notification package DLLs that handle Winlogon events
- `Userinit` - points to userinit.exe, the user initialization program executed when a user logs on.
- `Shell` - points to explorer.exe, the system shell executed when a user logs on.
- `mpnotify` - can point to an exe.

You can also use the GPExtensions of Winlogon:
Set `DllName` under `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{GUID}\` to the path of your DLL.


### Requirements
Administrator privileges to write to the registry.

### The achieved persistence
The result differs per registry key.
For Userinint, the executable is loaded on logon, and should be executed for 30 seconds.

The GPExtensions key load the DLL when a policy is applied and should.

All techniques result in admin privileges.

### More information
- https://persistence-info.github.io/Data/mpnotify.html
- https://attack.mitre.org/techniques/T1547/004/
- https://web.archive.org/web/20201006201906/https://blogs.blackberry.com/en/2013/09/windows-registry-persistence-part-2-the-run-keys-and-search-order
- https://persistence-info.github.io/Data/gpoextension.html
- https://docs.microsoft.com/en-us/previous-versions/windows/desktop/policy/creating-a-policy-callback-function
- https://www.hexacorn.com/blog/2018/10/11/beyond-good-ol-run-key-part-92/
