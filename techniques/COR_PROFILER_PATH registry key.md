### Origin of the technique
The .NET framework allows developers to measure their code performance with a user-provided DLL.

### How to achieve persistence
You have to set a few environment variables:
- `COR_ENABLE_PROFILING=1`
- `COR_PROFILER={<CLSID of profiler>}`
- `COR_PROFILER_PATH=<full path of the profiler DLL>`

You can store environment variables in the registry under `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment`
or `HKEY_CURRENT_USER\Environment`

### Requirements
User privileges are enough to set it for the current user.

### The achieved persistence
Each .NET process that loads the Common Language Runtime (CLR) will load the malicious DLL. For example, when starting PowerShell. It requires a reboot to work.


### More information
- https://redcanary.com/blog/cor_profiler-for-persistence/
- https://attack.mitre.org/techniques/T1574/012/