### Origin of the technique
When a new device is connected to the computer, a Device Event Handler is used to specify the software to be used to open the medium.

### How to achieve persistence
What event (such as a movie dvd is inserted) is matched to event handler. This is written in the registry: `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\AutoplayHandlers\EventHandlers`
They match to names in the`handlers` registry.
You can change a Autoplay handler in the registry: `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\explorer\AutoplayHandlers\Handlers\`
Some interesting values are:
- `Action` - specify exe
- `InitCmdLine` - specify arguments

### Requirements
Admin privileges

### The achieved persistence
User privileges, when an attached medium is opened by autoplay. Can run an exe or a DLL.


### More information
- https://www.hexacorn.com/blog/2019/09/07/beyond-good-ol-run-key-part-114/
- https://learn.microsoft.com/en-us/windows/win32/shell/how-to-register-a-handler-for-a-device-event