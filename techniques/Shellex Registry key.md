# Shellex Registry key
### Origin of the technique
When you right-click a file in Windows Explorer or on the Desktop, a menu shows up. It is possible to extend the features of this menu by registering a DLL.
This is one example of many of such DLLs that can be used to extend the Explorer tool.

### How to achieve persistence
The different feature names are: `ContextMenuHandlers`, `CopyHookHandlers`, `ShellIconOverlayIdentifies`, `DragDropHandlers`, `ShellExecuteHooks`.

You can add Context menu handler DLLs in multiple locations in the registry, including:
- `HKCU\Software\Classes\*\ShellEx\<feature name>`
- `HKCU\Software\Classes\Directory\ShellEx\<feature name>
- `HKCU\Software\Classes\Directory\Background\ShellEx\<feature name>

Under this key, add a key with as `(Default)` value a valid CLSID of a COM DLL. The registered DLL should be a valid Context menu handler DLL.
Also works under `HKLM`.
### Requirements
User privileges are required.

### The achieved persistence
When the target operation is performed by the user, the process is launched, with user privileges.

### More information
- https://pentestlab.blog/2023/03/13/persistence-context-menu/
- https://ristbs.github.io/2023/02/15/hijack-explorer-context-menu-for-persistence-and-fun.html
- https://github.com/RistBS/ContextMenuHijack