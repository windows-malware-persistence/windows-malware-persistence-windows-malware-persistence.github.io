### Origin of the technique
When you right-click a file in Windows explorer or on the Desktop, a menu shows up. It is possible to extend the features of this menu by registering a DLL.

### How to achieve persistence
You can add Context menu handler DLLs in multiple locations in the registry, including:
- `HKCU\Software\Classes\*\ShellEx\ContextMenuHandlers`
- `HKCU\Software\Classes\Directory\ShellEx\ContextMenuHandlers`
- `HKCU\Software\Classes\Directory\Background\ShellEx\ContextMenuHandlers`
- `HKLM\Software\Classes\*\ShellEx\ContextMenuHandlers`
- `HKLM\Software\Classes\Directory\ShellEx\ContextMenuHandlers`
- `HKLM\Software\Classes\Directory\Background\ShellEx\ContextMenuHandlers`
Under this key, add a key with as `(Default)` value a valid CLSID of a COM DLL. The registered DLL should be a valid Context menu handler DLL.
### Requirements
User privileges are required.

### The achieved persistence
When the user right-click a file, the process is launched, with user privileges.

### More information
- https://pentestlab.blog/2023/03/13/persistence-context-menu/
- https://ristbs.github.io/2023/02/15/hijack-explorer-context-menu-for-persistence-and-fun.html
- https://github.com/RistBS/ContextMenuHijack